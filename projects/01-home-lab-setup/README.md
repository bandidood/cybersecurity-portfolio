# üè† Projet 01 : Laboratoire de Cybers√©curit√© √† Domicile

## üéØ Objectifs P√©dagogiques
- Construire un environnement de test s√©curis√© et isol√©
- Ma√Ætriser la virtualisation pour la cybers√©curit√©
- Impl√©menter une architecture r√©seau segment√©e
- Configurer des outils de monitoring et de d√©tection
- Cr√©er un environnement reproductible et document√©

## üìå Contexte Professionnel
Dans le domaine de la cybers√©curit√©, disposer d'un laboratoire personnel est essentiel pour :
- **Formation continue** : Tester nouvelles techniques et outils
- **Recherche** : Analyser malwares et vuln√©rabilit√©s en s√©curit√©
- **D√©veloppement** : Cr√©er et valider des solutions de s√©curit√©
- **Certification** : Pr√©parer OSCP, CEH, CISSP
- **D√©monstration** : Pr√©senter comp√©tences techniques aux employeurs

## ‚úÖ Pr√©requis

### üíª Mat√©riel Recommand√©
- **CPU** : Intel i5/i7 ou AMD Ryzen 5/7 (support virtualisation)
- **RAM** : 16 GB minimum (32 GB recommand√©)
- **Stockage** : 500 GB SSD disponible
- **R√©seau** : Connexion stable pour t√©l√©chargements

### üß† Comp√©tences N√©cessaires
- Bases de l'administration syst√®me (Windows/Linux)
- Concepts r√©seaux (TCP/IP, VLAN, routage)
- Utilisation basique de la ligne de commande
- Notions de virtualisation

### üõ†Ô∏è Outils Requis
- **Hyperviseur** : VMware Workstation Pro, VirtualBox, ou Hyper-V
- **Images ISO** : 
  - Kali Linux (pentest)
  - Ubuntu Server (services)
  - Windows Server 2019/2022 (AD)
  - pfSense (pare-feu)
  - DVWA, Metasploitable (cibles)

## üèóÔ∏è Architecture du Laboratoire

### üìä Topologie R√©seau
```
Internet
    |
[Router Physique] (192.168.1.1/24)
    |
[pfSense VM] (Gateway)
    |
‚îú‚îÄ‚îÄ DMZ (172.16.1.0/24)
‚îÇ   ‚îú‚îÄ‚îÄ Web Server (172.16.1.10)
‚îÇ   ‚îî‚îÄ‚îÄ Mail Server (172.16.1.20)
‚îÇ
‚îú‚îÄ‚îÄ LAN Interne (192.168.100.0/24)
‚îÇ   ‚îú‚îÄ‚îÄ Domain Controller (192.168.100.10)
‚îÇ   ‚îú‚îÄ‚îÄ File Server (192.168.100.20)
‚îÇ   ‚îî‚îÄ‚îÄ Workstations (192.168.100.50-99)
‚îÇ
‚îú‚îÄ‚îÄ Red Team Network (10.0.0.0/24)
‚îÇ   ‚îú‚îÄ‚îÄ Kali Linux (10.0.0.10)
‚îÇ   ‚îú‚îÄ‚îÄ Cobalt Strike (10.0.0.20)
‚îÇ   ‚îî‚îÄ‚îÄ C2 Server (10.0.0.30)
‚îÇ
‚îî‚îÄ‚îÄ Blue Team Network (172.16.2.0/24)
    ‚îú‚îÄ‚îÄ SIEM (172.16.2.10)
    ‚îú‚îÄ‚îÄ IDS/IPS (172.16.2.20)
    ‚îî‚îÄ‚îÄ SOC Tools (172.16.2.30)
```

## üõ†Ô∏è Plan d'Action Structur√©

### Phase 1 : Pr√©paration (Semaine 1)
1. **Installation hyperviseur** et configuration r√©seau
2. **T√©l√©chargement ISOs** et cr√©ation structure
3. **Tests initialisation** environnement

### Phase 2 : Infrastructure (Semaine 2)  
4. **D√©ploiement pfSense** et segmentation r√©seau
5. **Installation Active Directory** et services Windows
6. **Configuration monitoring** ELK Stack

### Phase 3 : S√©curit√© (Semaine 3)
7. **D√©ploiement Kali Linux** et outils pentest
8. **Installation DVWA/Metasploitable** (cibles)
9. **Configuration IDS/IPS** et d√©tection

### Phase 4 : Validation (Semaine 4)
10. **Tests connectivit√©** et isolation
11. **Validation s√©curit√©** et performance
12. **Documentation finale** et pr√©sentation

## üíª Scripts d'Automatisation

### üöÄ Script de D√©ploiement Principal
```bash
#!/bin/bash
# deploy-lab.sh

set -e

echo "üèóÔ∏è D√©ploiement du laboratoire cybers√©curit√©..."

# V√©rification pr√©requis
check_requirements() {
    echo "üîç V√©rification des pr√©requis..."
    
    if ! command -v vmrun &> /dev/null; then
        echo "‚ùå VMware Workstation non d√©tect√©"
        exit 1
    fi
    
    AVAILABLE_SPACE=$(df -h ~ | awk 'NR==2{print $4}' | sed 's/G//')
    if [ $AVAILABLE_SPACE -lt 500 ]; then
        echo "‚ùå Espace disque insuffisant (500GB requis)"
        exit 1
    fi
    
    echo "‚úÖ Pr√©requis valid√©s"
}

# Cr√©ation structure
create_structure() {
    echo "üìÅ Cr√©ation de la structure..."
    mkdir -p ~/lab/{vms,isos,configs,scripts,evidence}
    echo "‚úÖ Structure cr√©√©e"
}

# T√©l√©chargement ISOs
download_isos() {
    echo "‚¨áÔ∏è T√©l√©chargement des images ISO..."
    cd ~/lab/isos
    
    if [ ! -f "kali-linux.iso" ]; then
        wget -O kali-linux.iso "https://cdimage.kali.org/kali-2024.1/kali-linux-2024.1-installer-amd64.iso"
    fi
    
    if [ ! -f "ubuntu-server.iso" ]; then
        wget -O ubuntu-server.iso "https://releases.ubuntu.com/22.04/ubuntu-22.04.3-live-server-amd64.iso"
    fi
    
    echo "‚úÖ ISOs t√©l√©charg√©s"
}

# Ex√©cution principale
main() {
    check_requirements
    create_structure
    download_isos
    
    echo "üéâ Laboratoire d√©ploy√© avec succ√®s !"
    echo "üìã Prochaines √©tapes :"
    echo "1. Configurer pfSense via interface web"
    echo "2. Installer Active Directory"
    echo "3. D√©ployer ELK Stack"
    echo "4. Configurer Kali Linux"
    echo "5. Lancer tests de validation"
}

main "$@"
```

### üîß Script de Monitoring
```python
#!/usr/bin/env python3
# health-check.py

import subprocess
import socket
import psutil
from datetime import datetime

class LabHealthChecker:
    def __init__(self):
        self.report = []
        self.timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    
    def check_system_resources(self):
        """V√©rification ressources syst√®me"""
        print("üñ•Ô∏è V√©rification ressources syst√®me...")
        
        cpu_percent = psutil.cpu_percent(interval=1)
        memory = psutil.virtual_memory()
        disk = psutil.disk_usage('/')
        
        self.report.append(f"CPU Usage: {cpu_percent}%")
        self.report.append(f"RAM Usage: {memory.percent}%")
        self.report.append(f"Disk Usage: {(disk.used/disk.total)*100:.1f}%")
        
        print("‚úÖ Ressources syst√®me v√©rifi√©es")
    
    def check_vm_status(self):
        """V√©rification √©tat des VMs"""
        print("üñ•Ô∏è V√©rification √©tat des VMs...")
        
        vms = ["pfSense", "Kali-Attacker", "DC-Server", "Ubuntu-SIEM", "DVWA-Target"]
        
        for vm in vms:
            try:
                result = subprocess.run(["vmrun", "list"], capture_output=True, text=True)
                if vm in result.stdout:
                    self.report.append(f"VM {vm}: ‚úÖ Running")
                else:
                    self.report.append(f"VM {vm}: ‚ùå Stopped")
            except Exception as e:
                self.report.append(f"VM {vm}: ‚ùå Error - {e}")
        
        print("‚úÖ √âtat des VMs v√©rifi√©")
    
    def check_network_connectivity(self):
        """Test connectivit√© r√©seau"""
        print("üåê Test connectivit√© r√©seau...")
        
        targets = {
            "pfSense LAN": "192.168.100.1",
            "Domain Controller": "192.168.100.10", 
            "SIEM Server": "172.16.2.10",
            "DMZ Web": "172.16.1.10"
        }
        
        for name, ip in targets.items():
            try:
                result = subprocess.run(["ping", "-c", "1", "-W", "2", ip], 
                                      capture_output=True, timeout=5)
                if result.returncode == 0:
                    self.report.append(f"Network {name} ({ip}): ‚úÖ Reachable")
                else:
                    self.report.append(f"Network {name} ({ip}): ‚ùå Unreachable")
            except Exception as e:
                self.report.append(f"Network {name} ({ip}): ‚ùå Error - {e}")
        
        print("‚úÖ Connectivit√© r√©seau test√©e")
    
    def generate_report(self):
        """G√©n√©ration rapport final"""
        print("\n" + "="*50)
        print(f"üîç RAPPORT HEALTH CHECK - {self.timestamp}")
        print("="*50)
        
        for item in self.report:
            print(item)
        
        # Sauvegarde rapport
        filename = f"health-report-{datetime.now().strftime('%Y%m%d-%H%M%S')}.txt"
        with open(filename, "w") as f:
            f.write(f"Health Check Report - {self.timestamp}\n")
            f.write("="*50 + "\n")
            for item in self.report:
                f.write(item + "\n")
        
        print(f"\n‚úÖ Rapport sauvegard√©: {filename}")
    
    def run_full_check(self):
        """Ex√©cution check complet"""
        print("üöÄ D√©marrage Health Check complet...\n")
        
        self.check_system_resources()
        self.check_vm_status()
        self.check_network_connectivity()
        self.generate_report()
        
        print("\nüéâ Health Check termin√© !")

if __name__ == "__main__":
    checker = LabHealthChecker()
    checker.run_full_check()
```

## üîê Analyse des Risques & Contre-mesures

### ‚ö†Ô∏è Risques Identifi√©s

| Risque | Impact | Probabilit√© | Contre-mesure |
|--------|--------|-------------|---------------|
| **Exposition accidentelle sur Internet** | Critique | Faible | Isolation r√©seau, pas de port forwarding |
| **Malware √©chappant de la VM** | √âlev√© | Faible | Snapshots, r√©seau isol√©, antivirus host |
| **Fuite de donn√©es de test** | Moyen | Moyen | Donn√©es anonymis√©es uniquement |
| **Surcharge ressources syst√®me** | Faible | √âlev√© | Monitoring, allocation dynamique |
| **Acc√®s non autoris√© au lab** | Moyen | Faible | Chiffrement VMs, mots de passe forts |

### üõ°Ô∏è Mesures de S√©curit√© Impl√©ment√©es

#### 1. Isolation R√©seau
```bash
# Configuration pfSense - R√®gles strictes
# Bloquer tout trafic par d√©faut
# DMZ isol√©e du LAN
# Red Team isol√© du Blue Team
# Logs de toutes les connexions
```

#### 2. Chiffrement et Authentification
```bash
# Chiffrement des VMs
vmware-vdiskmanager -e -k "AES-256" virtual-disk.vmdk

# Mots de passe complexes
# Admin: 16+ caract√®res, sp√©ciaux
# Services: Cl√©s SSH, certificats
```

#### 3. Sauvegarde et R√©cup√©ration
```bash
#!/bin/bash
# backup-lab.sh

BACKUP_DIR="/backup/lab-$(date +%Y%m%d)"
mkdir -p "$BACKUP_DIR"

# Snapshot des VMs critiques
vmrun snapshot ~/lab/vms/pfSense.vmx "backup-$(date +%Y%m%d)"
vmrun snapshot ~/lab/vms/DC-Server.vmx "backup-$(date +%Y%m%d)"

# Sauvegarde configurations
cp -r ~/lab/configs "$BACKUP_DIR/"
cp -r ~/lab/scripts "$BACKUP_DIR/"

echo "‚úÖ Sauvegarde termin√©e: $BACKUP_DIR"
```

## ‚úÖ Bonnes Pratiques Professionnelles

### üéØ Standards de Documentation
- **Nomenclature** : Convention de nommage claire (VM-Role-Version)
- **Versioning** : Git pour scripts et configurations
- **Changelog** : Tra√ßabilit√© des modifications
- **Architecture** : Diagrammes √† jour

### üîí S√©curit√© Op√©rationnelle
- **Principle of Least Privilege** sur tous les comptes
- **Network Segmentation** stricte entre environnements
- **Regular Patching** des syst√®mes et outils
- **Incident Response** : proc√©dures document√©es

### üìà Performance et Optimisation
```bash
# Optimisation VMware
# Allocation RAM dynamique
# Disques SSD pour VMs critiques
# CPU affinity pour isolation

# Monitoring proactif
# Alertes ressources > 80%
# Health checks automatis√©s
# M√©triques performance
```

### üéì Formation Continue
- **Documentation** : Wiki interne avec proc√©dures
- **Labs Scenarios** : Exercices pratiques r√©guliers
- **Knowledge Sharing** : Sessions techniques √©quipe
- **Veille Technologique** : Suivi nouvelles menaces

## üìÇ Structure Git Recommand√©e

```
01-home-lab-setup/
‚îú‚îÄ‚îÄ README.md                    # Documentation principale
‚îú‚îÄ‚îÄ CHANGELOG.md                 # Historique modifications
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ architecture.md          # Architecture d√©taill√©e
‚îÇ   ‚îú‚îÄ‚îÄ network-diagram.png      # Sch√©ma r√©seau
‚îÇ   ‚îú‚îÄ‚îÄ vm-specifications.md     # Specs des VMs
‚îÇ   ‚îú‚îÄ‚îÄ troubleshooting.md       # Guide d√©pannage
‚îÇ   ‚îî‚îÄ‚îÄ security-hardening.md    # Durcissement s√©curit√©
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ setup/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deploy-lab.sh        # D√©ploiement automatique
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ configure-network.sh # Configuration r√©seau
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ install-tools.sh     # Installation outils
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ create-vms.sh        # Cr√©ation VMs
‚îÇ   ‚îú‚îÄ‚îÄ monitoring/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ health-check.py      # V√©rification sant√©
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ resource-monitor.sh  # Monitoring ressources
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ network-test.py      # Tests r√©seau
‚îÇ   ‚îî‚îÄ‚îÄ maintenance/
‚îÇ       ‚îú‚îÄ‚îÄ backup-lab.sh        # Sauvegarde
‚îÇ       ‚îú‚îÄ‚îÄ cleanup.sh           # Nettoyage
‚îÇ       ‚îî‚îÄ‚îÄ update-systems.sh    # Mises √† jour
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îú‚îÄ‚îÄ pfsense/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ firewall-rules.xml   # R√®gles pare-feu
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ vpn-config.xml       # Configuration VPN
‚îÇ   ‚îú‚îÄ‚îÄ elk/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ elasticsearch.yml    # Config Elasticsearch
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logstash.conf        # Config Logstash
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ kibana.yml           # Config Kibana
‚îÇ   ‚îú‚îÄ‚îÄ windows/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gpo-settings.xml     # Politiques de groupe
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ad-schema.ldif       # Sch√©ma Active Directory
‚îÇ   ‚îî‚îÄ‚îÄ kali/
‚îÇ       ‚îú‚îÄ‚îÄ tools-list.txt       # Liste outils install√©s
‚îÇ       ‚îî‚îÄ‚îÄ custom-aliases.sh    # Aliases personnalis√©s
‚îú‚îÄ‚îÄ evidence/
‚îÇ   ‚îú‚îÄ‚îÄ screenshots/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pfsense-dashboard.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ kibana-dashboard.png
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ network-topology.png
‚îÇ   ‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ health-checks/       # Logs surveillance
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ deployment/          # Logs d√©ploiement
‚îÇ   ‚îî‚îÄ‚îÄ reports/
‚îÇ       ‚îú‚îÄ‚îÄ performance-analysis.pdf
‚îÇ       ‚îú‚îÄ‚îÄ security-assessment.pdf
‚îÇ       ‚îî‚îÄ‚îÄ lessons-learned.md
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ unit-tests/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test-scripts.py      # Tests unitaires scripts
‚îÇ   ‚îú‚îÄ‚îÄ integration-tests/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test-connectivity.sh # Tests int√©gration
‚îÇ   ‚îî‚îÄ‚îÄ security-tests/
‚îÇ       ‚îî‚îÄ‚îÄ vulnerability-scan.py # Tests s√©curit√©
‚îî‚îÄ‚îÄ presentations/
    ‚îú‚îÄ‚îÄ lab-overview.pptx        # Pr√©sentation g√©n√©rale
    ‚îú‚îÄ‚îÄ technical-details.pdf    # D√©tails techniques
    ‚îî‚îÄ‚îÄ demo-scenarios.md        # Sc√©narios de d√©monstration
```

## üìú R√©f√©rences

### üìö Documentation Officielle
- **VMware Workstation** : [Documentation VMware](https://docs.vmware.com/en/VMware-Workstation-Pro/)
- **pfSense** : [pfSense Documentation](https://docs.netgate.com/pfsense/)
- **Kali Linux** : [Kali Documentation](https://www.kali.org/docs/)
- **ELK Stack** : [Elastic Documentation](https://www.elastic.co/guide/)

### üîí Standards de S√©curit√©
- **NIST Cybersecurity Framework** : [NIST CSF](https://www.nist.gov/cyberframework)
- **ISO 27001** : Management de la s√©curit√© de l'information
- **CIS Controls** : [Center for Internet Security](https://www.cisecurity.org/controls/)
- **OWASP** : [OWASP Guidelines](https://owasp.org/)

### üéì Ressources d'Apprentissage
- **SANS Institute** : [SANS Training](https://www.sans.org/)
- **Cybrary** : [Free Cybersecurity Training](https://www.cybrary.it/)
- **VulnHub** : [Vulnerable VMs](https://www.vulnhub.com/)
- **TryHackMe** : [Hands-on Learning](https://tryhackme.com/)

---

## üéØ Livrables du Projet

### ‚úÖ Checklist de Validation
- [ ] Infrastructure d√©ploy√©e et fonctionnelle
- [ ] Tous les r√©seaux configur√©s et isol√©s
- [ ] VMs op√©rationnelles avec services
- [ ] Monitoring et alerting actifs
- [ ] Documentation compl√®te r√©dig√©e
- [ ] Scripts test√©s et valid√©s
- [ ] Sauvegardes configur√©es
- [ ] Tests de s√©curit√© r√©alis√©s
- [ ] Pr√©sentation technique pr√©par√©e
- [ ] Repository Git organis√© et pouss√©

### üìä M√©triques de Succ√®s
- **Temps de d√©ploiement** : < 4 heures (automatis√©)
- **Disponibilit√©** : 99.5% uptime
- **Performance** : < 2s r√©ponse services web
- **S√©curit√©** : 0 vuln√©rabilit√© critique d√©tect√©e
- **Documentation** : 100% proc√©dures couvertes

### üèÜ Comp√©tences D√©montr√©es
- Architecture r√©seau s√©curis√©e
- Virtualisation et isolation
- Scripting et automatisation
- Monitoring et supervision
- Documentation technique
- Gestion de projet cybers√©curit√©

---

**üìû Support** : En cas de probl√®me, consulter le guide de d√©pannage ou cr√©er une issue sur le repository GitHub.

**üîÑ Mise √† jour** : Ce laboratoire √©volue r√©guli√®rement. V√©rifier les mises √† jour dans CHANGELOG.md.